<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notas de artículos – Ventilación Mecánica I</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>body{font-family:'Poppins',sans-serif;background:#f9f9fb}.card{border:none;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.06)}.card-header{background:#ecfeff;color:#0e7490;font-weight:700}.rubric-table th,.rubric-table td{vertical-align:top;text-align:center}.rubric-table th:first-child,.rubric-table td:first-child{text-align:left;width:45%}.score-options-wrapper{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}.score-value{font-size:11px;color:#555}</style>
</head>
<body>
  <div class="container my-4">
    <header class="text-center mb-4">
      <h1 class="h4 text-info">Rúbrica – Presentación de artículos</h1>
      <p class="text-muted mb-0">Curso Ventilación Mecánica I</p>
      <p><a href="index.html" class="small">← Volver al inicio</a></p>
    </header>

    <form id="rubricForm" class="needs-validation" novalidate>
      <section class="card mb-3"><div class="card-header">Información</div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-6"><label class="form-label">Evaluador</label><input id="evaluator" class="form-control" required></div>
            <div class="col-md-6"><label class="form-label">Residente</label><input id="resident" class="form-control" required></div>
            <div class="col-md-6"><label class="form-label">Fecha</label><input id="date" type="date" class="form-control" required></div>
            <div class="col-md-6"><label class="form-label">Artículo</label><input id="paper" class="form-control" required></div>
          </div>
        </div>
      </section>

      <section class="card rubric-section" data-max-score="40" id="s1">
        <div class="card-header">I. Comprensión y análisis (40 pts) <span class="float-end text-muted score-display">Puntos: 0 / 40</span></div>
        <div class="card-body p-0"><table class="table mb-0 rubric-table"><tbody>
          <tr><td>Planteamiento de la pregunta clínica y objetivos</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="q1" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="q1" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="q1" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="q1" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="q1" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="q1" value="0">
          </div></td></tr>
          <tr><td>Metodología y validez interna</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="q2" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="q2" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="q2" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="q2" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="q2" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="q2" value="0">
          </div></td></tr>
          <tr><td>Análisis de resultados y estadísticas</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="q3" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="q3" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="q3" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="q3" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="q3" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="q3" value="0">
          </div></td></tr>
          <tr><td>Limitaciones y sesgos</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="q4" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="q4" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="q4" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="q4" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="q4" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="q4" value="0">
          </div></td></tr>
        </tbody></table></div>
      </section>

      <section class="card rubric-section" data-max-score="30" id="s2">
        <div class="card-header">II. Presentación y síntesis (30 pts) <span class="float-end text-muted score-display">Puntos: 0 / 30</span></div>
        <div class="card-body p-0"><table class="table mb-0 rubric-table"><tbody>
          <tr><td>Estructura y claridad</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="p1" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="p1" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="p1" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="p1" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="p1" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="p1" value="0">
          </div></td></tr>
          <tr><td>Síntesis de hallazgos clave</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="p2" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="p2" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="p2" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="p2" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="p2" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="p2" value="0">
          </div></td></tr>
          <tr><td>Uso adecuado de figuras/tablas</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="p3" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="p3" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="p3" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="p3" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="p3" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="p3" value="0">
          </div></td></tr>
        </tbody></table></div>
      </section>

      <section class="card rubric-section" data-max-score="30" id="s3">
        <div class="card-header">III. Aplicabilidad clínica y discusión (30 pts) <span class="float-end text-muted score-display">Puntos: 0 / 30</span></div>
        <div class="card-body p-0"><table class="table mb-0 rubric-table"><tbody>
          <tr><td>Implicaciones para la práctica</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="a1" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="a1" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="a1" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="a1" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="a1" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="a1" value="0">
          </div></td></tr>
          <tr><td>Participación y respuestas a preguntas</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="a2" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="a2" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="a2" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="a2" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="a2" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="a2" value="0">
          </div></td></tr>
          <tr><td>Conclusiones y recomendaciones</td><td><div class="score-options-wrapper">
            <label class="score-value">10</label><input class="form-check-input" type="radio" name="a3" value="10" required>
            <label class="score-value">8</label><input class="form-check-input" type="radio" name="a3" value="8">
            <label class="score-value">6</label><input class="form-check-input" type="radio" name="a3" value="6">
            <label class="score-value">4</label><input class="form-check-input" type="radio" name="a3" value="4">
            <label class="score-value">2</label><input class="form-check-input" type="radio" name="a3" value="2">
            <label class="score-value">0</label><input class="form-check-input" type="radio" name="a3" value="0">
          </div></td></tr>
        </tbody></table></div>
      </section>

      <section class="card"><div class="card-body text-center">
        <h4>Total: <span id="total">0 / 100</span></h4>
        <button type="button" id="calc" class="btn btn-primary me-2">Validar y Calcular</button>
        <button type="button" id="pdf" class="btn btn-success" disabled>Exportar PDF</button>
        <button type="reset" class="btn btn-warning ms-2">Limpiar</button>
      </div></section>
    </form>
  </div>

  <script>
    const sections=document.querySelectorAll('.rubric-section');
    const totalEl=document.getElementById('total');
    function sectionScore(sec){let s=0;sec.querySelectorAll('input[type=radio]:checked').forEach(r=>s+=parseInt(r.value||'0'));return s;}
    function update(){let t=0;sections.forEach(sec=>{const s=sectionScore(sec);const m=parseInt(sec.dataset.maxScore,10);sec.querySelector('.score-display').textContent=`Puntos: ${s} / ${m}`;t+=s;});totalEl.textContent=`${t} / 100`;return t;}
    document.getElementById('rubricForm').addEventListener('change',e=>{if(e.target.type==='radio'){update();document.getElementById('pdf').disabled=true;}});
    document.getElementById('calc').addEventListener('click',()=>{const form=document.getElementById('rubricForm');if(!form.checkValidity()){form.classList.add('was-validated');alert('Complete todos los criterios');return;}form.classList.remove('was-validated');update();document.getElementById('pdf').disabled=false;});
    document.getElementById('pdf').addEventListener('click',async()=>{const { jsPDF }=window.jspdf;const pdf=new jsPDF({unit:'mm',format:'a4'});const el=document.body;const canvas=await html2canvas(el,{scale:1.2,backgroundColor:'#fff'});const img=canvas.toDataURL('image/png',0.92);const pageW=pdf.internal.pageSize.getWidth();const pageH=pdf.internal.pageSize.getHeight();const ratio=Math.min(pageW/canvas.width,pageH/canvas.height);const w=canvas.width*ratio;const h=canvas.height*ratio;pdf.addImage(img,'PNG',(pageW-w)/2,5,w,h);pdf.save(`Notas_Articulos_${(document.getElementById('resident').value||'Residente').replace(/\s+/g,'_')}_${document.getElementById('date').value||new Date().toISOString().slice(0,10)}.pdf`);});
  </script>
</body>
</html>
